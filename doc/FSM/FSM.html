<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: FSM::FSM
  
    &mdash; Documentation by YARD 0.8.3
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../';
  framesUrl = "../frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (F)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../FSM.html" title="FSM (module)">FSM</a></span></span>
     &raquo; 
    <span class="title">FSM</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: FSM::FSM
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">FSM::FSM</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/barebone-fsm.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>This class implements the finite-state machine. FSM class exposes the
states it contains and can trigger an event. States are created on the fly
first time it's referenced through index operator [].</p>

<p>The FSM state transits to the default state if the latest event does not
define the next state. If default state is not set, then state does not
change on undefined state. The initial state of the FSM is the first state
mentioned. This can be either the default state if defined or the first
referenced state.</p>

<h2>Usage</h2>

<pre class="code ruby"><code><span class='id identifier rubyid_fsm'>fsm</span> <span class='op'>=</span> <span class='const'>FSM</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='symbol'>:default_state</span>
<span class='id identifier rubyid_fsm'>fsm</span><span class='lbracket'>[</span><span class='symbol'>:default_state</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_event'>event</span><span class='lparen'>(</span><span class='symbol'>:first_event</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='comment'># the state is defined and referenced at the same time
</span>  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The first transition from the default_state to state_name</span><span class='tstring_end'>&quot;</span></span>
  <span class='symbol'>:state_name</span> <span class='comment'># the next state is defined here
</span><span class='kw'>end</span></code></pre>


  </div>
</div>
<div class="tags">
  

</div>



  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#event-instance_method" title="#event (instance method)">- (Object) <strong>event</strong>(event_name) </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>It triggers the event_name event and changes the state of the FSM to its
new state.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#%5B%5D-instance_method" title="#[] (instance method)">- (Object) <strong>[]</strong>(state_name = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>It returns the FSMState object for state_name.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#build-instance_method" title="#build (instance method)">- (Object) <strong>build</strong>(&amp;build_block) </a>
    

    
      (also: #run)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The #build/#run method sets up the states and events as given in the
build_block.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (FSM) <strong>initialize</strong>(default_state = nil) </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Creates a new FSM object with an optional default state set.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#state-instance_method" title="#state (instance method)">- (Object) <strong>state</strong>(state_name = nil, &amp;state_block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>When the state_block is provided, it sets up a new state.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_s-instance_method" title="#to_s (instance method)">- (Object) <strong>to_s</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="FSM::FSM (class)">FSM</a></span></tt>) <strong>initialize</strong>(default_state = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Creates a new FSM object with an optional default state set.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


98
99
100
101
102
103
104</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/barebone-fsm.rb', line 98</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_default_state'>default_state</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span> 
  <span class='ivar'>@states</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_default_state'>default_state</span> <span class='kw'>then</span>
    <span class='ivar'>@default</span> <span class='op'>=</span> <span class='id identifier rubyid_default_state'>default_state</span> 
    <span class='ivar'>@states</span><span class='lbracket'>[</span><span class='ivar'>@default</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>FSMState</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='ivar'>@default</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="event=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="event-instance_method">
  
    - (<tt>Object</tt>) <strong>event</strong>(event_name) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>It triggers the event_name event and changes the state of the FSM to its
new state. The :entry and :exit events are called on the leaving state and
the entering state. If the event does not mention the new state, then the
state changes to the default state.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


140
141
142
143
144
145
146
147
148
149</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/barebone-fsm.rb', line 140</span>

<span class='kw'>def</span> <span class='id identifier rubyid_event'>event</span><span class='lparen'>(</span><span class='id identifier rubyid_event_name'>event_name</span><span class='rparen'>)</span>
  <span class='ivar'>@event</span> <span class='op'>=</span> <span class='id identifier rubyid_event_name'>event_name</span> 
  <span class='ivar'>@states</span><span class='lbracket'>[</span><span class='ivar'>@state</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_event'>event</span> <span class='symbol'>:exit</span>
  <span class='id identifier rubyid_new_state'>new_state</span> <span class='op'>=</span> <span class='ivar'>@states</span><span class='lbracket'>[</span><span class='ivar'>@state</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_event'>event</span> <span class='id identifier rubyid_event_name'>event_name</span>
  <span class='id identifier rubyid_new_state'>new_state</span> <span class='op'>=</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='ivar'>@states</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span> <span class='id identifier rubyid_new_state'>new_state</span>
  <span class='id identifier rubyid_new_state'>new_state</span> <span class='op'>||=</span> <span class='ivar'>@default</span>
  <span class='id identifier rubyid_new_state'>new_state</span> <span class='op'>||=</span> <span class='ivar'>@state</span> 
  <span class='ivar'>@state</span> <span class='op'>=</span> <span class='id identifier rubyid_new_state'>new_state</span>
  <span class='ivar'>@states</span><span class='lbracket'>[</span><span class='ivar'>@state</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_event'>event</span> <span class='symbol'>:enter</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="[]-instance_method">
  
    - (<tt>Object</tt>) <strong>[]</strong>(state_name = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>It returns the FSMState object for state_name. If the state is missing,
then it first sets up the state, and then returns the newly created state.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


117
118
119
120
121
122
123
124</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/barebone-fsm.rb', line 117</span>

<span class='kw'>def</span> <span class='op'>[]</span><span class='lparen'>(</span><span class='id identifier rubyid_state_name'>state_name</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span> 
  <span class='id identifier rubyid_state_name'>state_name</span> <span class='op'>||=</span> <span class='ivar'>@state</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_state_name'>state_name</span> <span class='kw'>and</span> <span class='kw'>not</span> <span class='ivar'>@states</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span> <span class='id identifier rubyid_state_name'>state_name</span> <span class='kw'>then</span>
    <span class='ivar'>@states</span><span class='lbracket'>[</span><span class='id identifier rubyid_state_name'>state_name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>FSMState</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_state_name'>state_name</span><span class='rparen'>)</span>
    <span class='ivar'>@state</span> <span class='op'>||=</span> <span class='id identifier rubyid_state_name'>state_name</span>
  <span class='kw'>end</span>
  <span class='ivar'>@states</span><span class='lbracket'>[</span><span class='id identifier rubyid_state_name'>state_name</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="build-instance_method">
  
    - (<tt>Object</tt>) <strong>build</strong>(&amp;build_block) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='run-instance_method'>run</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The #build/#run method sets up the states and events as given in the
build_block. Only state and event methods are supported within the
build_block with the name of the state/event and a block supplied. The
operation for each such line is carried out by the #state/#event method.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


154
155
156</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/barebone-fsm.rb', line 154</span>

<span class='kw'>def</span> <span class='id identifier rubyid_build'>build</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_build_block'>build_block</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_instance_eval'>instance_eval</span> <span class='op'>&amp;</span><span class='id identifier rubyid_build_block'>build_block</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="state-instance_method">
  
    - (<tt>Object</tt>) <strong>state</strong>(state_name = nil, &amp;state_block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>When the state_block is provided, it sets up a new state. Otherwise, when
the state_block is missing, the FSMState object for state_name is returned.
If called without any parameter, then the current state is returned.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


129
130
131
132
133
134
135</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/barebone-fsm.rb', line 129</span>

<span class='kw'>def</span> <span class='id identifier rubyid_state'>state</span><span class='lparen'>(</span><span class='id identifier rubyid_state_name'>state_name</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_state_block'>state_block</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span> <span class='kw'>then</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='op'>[]</span><span class='lparen'>(</span><span class='id identifier rubyid_state_name'>state_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span> <span class='op'>&amp;</span><span class='id identifier rubyid_state_block'>state_block</span>
  <span class='kw'>else</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='op'>[]</span><span class='lparen'>(</span><span class='id identifier rubyid_state_name'>state_name</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="to_s-instance_method">
  
    - (<tt>Object</tt>) <strong>to_s</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


106
107
108
109
110
111
112
113</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/barebone-fsm.rb', line 106</span>

<span class='kw'>def</span> <span class='id identifier rubyid_to_s'>to_s</span><span class='lparen'>(</span><span class='rparen'>)</span> 
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>FSM</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> 
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>: {</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> 
      <span class='ivar'>@states</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_st'>st</span><span class='op'>|</span> 
        <span class='lparen'>(</span><span class='id identifier rubyid_st'>st</span><span class='period'>.</span><span class='id identifier rubyid_state'>state</span><span class='op'>==</span><span class='ivar'>@state</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&gt;</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>+</span> <span class='id identifier rubyid_st'>st</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
      <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>, </span><span class='tstring_end'>'</span></span><span class='rparen'>)</span> <span class='op'>+</span> 
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>}</span><span class='tstring_end'>&quot;</span></span> 
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Sun Jan 20 19:31:56 2013 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.3 (ruby-1.9.3).
</div>

  </body>
</html>